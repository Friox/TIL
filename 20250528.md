# 2025. 05. 28.

## 🍀 DDD
**D**omain-**D**riven **D**esign

복잡한 비즈니스 도메인을 효과적으로 모델링하고, 소프트웨어에 비즈니스 규칙과 요구사항을 정확하게 반영하기 위한 설계 방법론  
개발자와 비개발자가 공통 언어로 소통하며, 도메인 모델을 중심으로 시스템을 설계하는 것.  
(도메인: 소프트웨어가 해결하고자 하는 문제 영역, 주문, 결제, 배송 등)

데이터 중심 설계는 데이터베이스의 테이블 구조와 데이터 흐름을 우선적으로 고려하여 시스템을 설계하는 특징을 가지고 있는 반면,  
도메인 주도 설계는 도메인 모델을 정의하고, 객체지향적으로 시스템을 구축하는 특징이 있다.

## 🍀 설계 과정
1. 전문가 이벤트 작성 (이벤트 스토밍)
    * 전문가 이벤트는 비즈니스 과정에서 발생한 중요한 사실을 의미한다.
    * 과거에 발생한 일이어야 한다.
    * 따라서 항상 과거형으로 작성해야 함
2. 커맨드 정의
    * 커맨드는 사용자가 시스템에 요청하는 행동이나 작업을 의미한다.
    * 시스템의 비즈니스 로직에 따라 수행되며, 일반적으로 사용자가 시스템에 어떤 작업을 요청했을 때 발생
    * 커맨드는 특정한 결과를 초래하며, 결과에 따라 도메인 이벤트가 발생할 수 있다.
    * 동사는 항상 현재형으로 작성해야 함
3. 외부 시스템 정의
    * 외부 시스템은 현재 시스템과 상호작용하거나 영향을 미치는 다른 시스템을 의미한다.
    * 데이터 제공, 인증, 통신 등 다양한 기능을 수행하며, 내부 시스템과의 연계를 통해 비즈니스 프로세스를 지원한다.
4. 액터 정의
    * 액터는 시스템의 기능을 사용하거나 영향을 미치는 주체로, 인간 사용자, 다른 시스템, 또는 조직을 포함할 수 있다.
    * 시스템의 요구사항을 정의하는 데 중요한 역할을 하며, 사용자의 행동과 요구를 반영한다.
5. 정책 정의
    * 정책은 시스템 내에서 특정 행동이나 결정이 어떻게 이루어져야 하는지를 정의하는 원칙이나 규칙을 의미한다.
    * 비즈니스 로직을 지원하며, 시스템의 일관성과 안정성을 유지하는 데 중요한 역할을 한다.
6. 애그리거트 정의 (애그리게이트라고도 함)
    * 애그리거트는 도메인 내에서 관련된 데이터와 비즈니스 로직을 캡슐화하는 집합체를 의미한다.
    * 특정 비즈니스 규칙을 유지하며, 일관성을 보장하는 단위로, 루트 엔티티를 통해 외부와 상호작용한다.
7. 바운디드 컨텍스트 도출 및 매핑
    * 연관된 애그리거트를 묶으면 바운디드 컨텍스트가 된다. 각 컨텍스트의 책임과 경계를 명확히 해야한다.
    * 여러 바운디드 컨텍스트 간의 관계를 정의한다.
    * 모델을 반복적으로 검토 및 개선하고 누락된 부분이나 중복된 부분을 조정한다.

## 🍀 CQRS
**C**ommand and **Q**uery **R**esponsibility **S**egregation

명령(Command)과 조회(Query)의 책임을 분리하는 소프트웨어 아키텍처 패턴.  
명령은 시스템의 상태를 변경하는 작업(예: 생성, 수정, 삭제 등)을 의미하고, 조회는 시스템의 상태를 조회하는 작업을 의미한다.  
CQRS는 이 두가지 책임을 각각 별도의 모델, 별도의 계층, 심지어는 별도의 레포지토리로 분리하여 처리한다.

이렇게 책임을 분리함으로써 확장성, 유지보수성, 보안과 성능을 챙길 수 있게 된다.  
정보조회를 위해 요구되는 복잡한 쿼리로 인해 성능에 부정적인 영향을 줄 수 있기때문에, 조회를 분리한다.

읽기와 쓰기 요구사항이 매우 다르거나, 읽기 트래픽이 월등히 많을때,  
복잡한 비즈니스 로직, 대규모 시스템, MSA 등에서 효과적이다.  
단순 CRUD 시스템에서는 오히려 과한 복잡성을 유발할 수 있으니 조심하자.